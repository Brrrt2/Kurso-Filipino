const lugarInfo = {
  Pilipinas: {
  text:"Si Jose Rizal ay ipinanganak noon Hunyo 19, 1861 sa Calamba, Laguna. Sa Pilipinas niya hinubog ang kanyang pagkatao, pagkabayani at pagmamalasakit sa bayan. Dito niya ginugol ang kanyang kabataan at nagsimulang maobserbahan ang kalagayan ng lipunan sa ilalim ng pamahalaang kolonyal ng Espanya. Dito niya rin isinulat ang kanyang mga nobela upang gisingin ang damdaming makabayan ng mga Pilipino laban sa pang-aabuso ng mga Kastilang prayle. Siya ay nakulong sa Fort Santiago, ipinatapon sa Dapitan, at sa huli ay binaril sa Bagumbayan noong Disyembre 30, 1896.",
  img: "https://images.pexels.com/photos/32243159/pexels-photo-32243159/free-photo-of-quezon-city-memorial-circle-monument-in-manila.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Singapura: { 
  text: "Si Rizal ay ilang ulit dumaan sa Singapore, una noong 1882 - at muli noong 1887, 1891 at 1896. Namangha siya sa kaayusan ng lungsod at ang kamalayan ng mga tao sa kanilang karapatan. Siya ay naglibot sa Botanical Garden, napuntahan ang Raffles Statue, mga templo at paaralan. Sa huli, itinangka ng kanyang mga tagasuporta na siya'y manatili dito upang maligtas mula sa pagkabilanggo.",
  img: "https://images.pexels.com/photos/29941695/pexels-photo-29941695/free-photo-of-merlion-statue-and-singapore-skyline.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"  
  },
  "Ceylon":{ 
  text: "Noong 1882, huminto si Rizal sa Point de Galle, Ceylon (ngayon ay Sri Lanka), habang lulan ng barkong Djemnah. Nabighani siya sa mga punong palma at sa katahimikan ng paligid. Sa Colombo, napansin nya na maayos na arkitektura at pagkakaiba nito sa Singapore at Maynila. Una ring niya nakita roon ang mga debotong Buddhist.",
  img: "https://www.planetware.com/wpimages/2020/01/sri-lanka-top-attractions-sigiriya.jpg"
  },
  Yemen: {
  text:"Isa sa mga hintuan ni Rizal ay ang Aden, Yemen noong Mayo, 27, 1882. Doon niya unang nakita ang mga kamelyo at nasubok ang kanyang kakayahan magsalita ng Pranses habang nakikipag-ugnayan sa mga kapwa manlalakbay. Inilarawan niya ang init ng lugar na mas mainit pa sa Maynila.",
  img: "https://images.pexels.com/photos/32267517/pexels-photo-32267517/free-photo-of-majestic-winter-mosque-landscape-with-snow.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  "Hong Kong": {
  text:"Tumira si Rizal sa Hong Kong noong 1891 at muling bumalik noong 1892. Nagtayo siya ng matagumpay ng klinika bilang optalmologo at sinamahan ang kanyang pamilya upang makalayo sa panganib sa Pilipinas. Dito niya binalak ang pagtatatag ng isang kolonya ng Pilipino sa North Borneo upang makapamuhay ng payapa.",
  img: "https://images.pexels.com/photos/792832/pexels-photo-792832.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Hapon: {
  text:"Dumalaw si Rizal sa Japan noong 1888 at namalagi sa Tokyo. Namangha siya sa kalinisan, katahimikan, at paggalang ng mga Hapon sa isa't isa. Nakilala niya si O-Sei-san (Seiko Usui), isang Haponesa na nagpakita ng pag-ibig sa kanya. Nag-aral din siya ng wikang Hapon at sinubukang unawain ang kultura at relihiyon nila.",
  img: "https://images.pexels.com/photos/1829980/pexels-photo-1829980.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Italya: {
  text:"Dumalaw si Rizal sa Italya noong 1882 at muling bumalik noong 1887. Namasyal siya sa Naples, Rome, Milan, Venice, at Florence. Sa Rome, binisita niya ang Colosseum, Forum, at iba pang makasaysayang lugar. Pinuri niya ang kasaysayan at sining ng bansa, at nakaramdam ng paghanga sa kabihasnang Romano.",
  img: "https://images.pexels.com/photos/6289876/pexels-photo-6289876.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Pransya: {
  text:"Bumisita si Rizal sa Paris noong 1883 at tumira doon mula 1885. Nag-aral siya ng optalmolohiya sa ilalim ni Dr. Louis de Weckert. Nakisalamuha siya sa mga Pilipinong artista tulad ni Juan Luna. Isinulat niya ang bahagi ng kanyang nobela at tinangkilik ang sining at kultura ng lungsod. Tumira rin siya sa Biarritz noong 1891, kung saan natapos niya ang 'El Filibusterismo' at nanligaw kay Nellie Boustead.",
  img: "https://images.pexels.com/photos/1530259/pexels-photo-1530259.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Espanya: {
  text:"Unang dumating si Rizal sa Espanya noong 1882 upang mag-aral. Sa Universidad Central de Madrid, kumuha siya ng Medisina at Pilosopiya. Isa siya sa mga aktibong miyembro ng kilusang propaganda, kasama sina Marcelo H. del Pilar at Graciano Lopez Jaena. Sumulat siya para sa La Solidaridad, at dito niya isinulat ang 'Noli Me Tangere' upang ilantad ang katiwalian sa Pilipinas.",
  img: "https://images.pexels.com/photos/1338393/pexels-photo-1338393.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Alemanya: {
  text:"Nanirahan si Rizal sa Heidelberg noong 1886 upang ipagpatuloy ang kanyang pag-aaral sa optalmolohiya kay Dr. Otto Becker. Sumulat siya ng tulang 'A Las Flores de Heidelberg'. Tumungo siya sa Berlin at nakisama sa mga siyentipikong lipunan. Dito niya natapos at ipinalimbag ang 'Noli Me Tangere' noong 1887, sa kabila ng kanyang kahirapan.",
  img: "https://images.pexels.com/photos/1128416/pexels-photo-1128416.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Switzerland: {
   text:"Noong 1887, bumisita si Rizal sa Geneva at iba pang bahagi ng Switzerland. Humanga siya sa kagandahan ng mga bundok at lawa, at ginugol ang oras sa pagsusulat at pagmumuni-muni. Naging panandaliang pahingahan ito para sa kanya bago siya bumalik sa mga lungsod na may aktibong kilusang pampulitika.",
  img: "https://images.pexels.com/photos/2399391/pexels-photo-2399391.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Macau: {
  text:"Noong Pebrero 1888, dumaan si Rizal sa Macau kasama si Jose Maria Basa. Namasyal sila sa mga kalsada, simbahan, at bahay ng mga Intsik. Naitala niya ang mga obserbasyon niya sa kultura, pagkain, at kaayusan ng lungsod at namangha sila sa mga arkitektura rito.",
  img: "https://images.pexels.com/photos/31189636/pexels-photo-31189636/free-photo-of-vibrant-macau-street-view-with-pedestrians.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  "Estados Unidos": {
   text:"Dumaan si Rizal sa Amerika noong 1888. Namalagi siya sa San Francisco at New York, at lumakbay sakay ng tren patungong silangang baybayin. Humanga siya sa teknolohiya at sistema ng gobyerno - pinuri nya ang kalayaan ng Amerika, ngunit nakita rin niya ang umiiral na diskriminasyon laban sa lahi tulad ng mga Aprikano at Asyano. Ang kanyang karanasan ay naging bahagi ng kanyang mas malalim na pananaw sa pandaigdigang kalayaan at karapatang pantao.",
  img: "https://images.pexels.com/photos/31248608/pexels-photo-31248608/free-photo-of-golden-gate-bridge-in-san-francisco-at-sunset.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
   "Inglatera":{
  text:"Nanirahan si Rizal sa London mula Disyembre 1888 hanggang Marso 1889. Nag-aral siya sa British Museum at inannotate ang 'Sucesos de las Islas Filipinas' ni Antonio de Morga. Layunin niya ay ipakita ang katotohanang kasaysayan ng Pilipinas mula sa paningin ng isang Pilipino. Nagsulat rin siya ng mga sanaysay para sa La Solidaridad habang nasa London.",
   img: "https://images.pexels.com/photos/77171/pexels-photo-77171.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  },
  Belhika: {
  text: "Nanirahan si Rizal sa Brussels noong 1890 upang makatipid. Dito niya isinulat ang ilang bahagi ng 'El Filibusterismo'. Dahil sa kakulangan sa pera, lumipat siya sa Ghent, kung saan niya ito ipinalimbag sa mas murang halaga noong 1891.",
  img: "https://images.pexels.com/photos/2960887/pexels-photo-2960887.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2"
  }
};

const card = document.getElementById("description-box");

document.querySelectorAll('.pin').forEach(pin => {
  pin.addEventListener('click', (e) => {
    e.stopPropagation();

    const label = pin.dataset.label;
    const info = lugarInfo[label] || {
      text: "Walang impormasyon.",
      img: "placeholder.jpg"
    };

    const titleEl = document.getElementById("location-title");

// Define flag URLs based on country labels
const flags = {
  "Pilipinas": "https://flagcdn.com/w40/ph.png",
  "Singapura": "https://flagcdn.com/w40/sg.png",
  "Ceylon": "https://flagcdn.com/w40/lk.png",
  "Yemen": "https://flagcdn.com/w40/ye.png",
  "Italya": "https://flagcdn.com/w40/it.png",
  "Pransya": "https://flagcdn.com/w40/fr.png",
  "Espanya": "https://flagcdn.com/w40/es.png",
  "Alemanya": "https://flagcdn.com/w40/de.png",
  "Switzerland": "https://flagcdn.com/w40/ch.png",
  "Hong Kong": "https://flagcdn.com/w40/hk.png",
  "Macau": "https://flagcdn.com/w40/mo.png",
  "Hapon": "https://flagcdn.com/w40/jp.png",
  "Estados Unidos": "https://flagcdn.com/w40/us.png",
  "Inglatera": "https://flagcdn.com/w40/gb.png",
  "Belhika": "https://flagcdn.com/w40/be.png"
}; 

// Update title with flag image + text
const flagUrl = flags[label];
titleEl.innerHTML = flagUrl
  ? `<img src="${flagUrl}" alt="${label} flag" style="width: 24px; margin-right: 8px; vertical-align: middle;" /> ${label}`
  : label;
    document.getElementById("location-description").textContent = info.text;
    document.getElementById("location-image").src = info.img;

    const pinRect = pin.getBoundingClientRect();
    const card = document.getElementById("description-box");
    const mapRect = document.querySelector('.map-container').getBoundingClientRect();

    // Calculate relative pin position
    const pinX = pinRect.left + pinRect.width / 2 - mapRect.left;
    const pinY = pinRect.top + pinRect.height / 2 - mapRect.top;

    const mapWidth = mapRect.width;

    // Smart horizontal positioning
    const cardOffsetX = 320; // Adjust card distance from pin horizontally
    const cardOffsetY = 20;  // Vertical offset

    let leftPos;
    if (pinX > mapWidth * 0.6) {
      // Too far right, place card to the left
      leftPos = pinX - cardOffsetX;
    } else {
      // Default: place to the right
      leftPos = pinX + 30;
    }

    // Apply new position
    card.style.top = `${pinY - card.offsetHeight / 2}px`;
    card.style.left = `${leftPos}px`;
    card.classList.add("show");
  });
});

// Fade out when clicking anywhere else
document.addEventListener('click', (e) => {
  if (!card.contains(e.target)) {
    card.classList.remove("show");
  }
});

const timeline = {
  Pilipinas: "Sa Pilipinas nagsimula at nagtapos ang makasaysayang paglalakbay ni Rizal. Umalis siya ng Maynila noong Mayo 3, 1882 upang mag-aral sa Europa. Bumalik siya noong 1892, at dito rin siya ipinatapon at kalaunan ay binitay sa Bagumbayan.",
  
  Singapura: "Si Rizal ay dumaan sa Singapore sa kanyang unang paglalakbay sa Europa. Namangha siya sa kaayusan at kalinisan ng lungsod. Isinulat niya ang kanyang obserbasyon sa kanyang talaarawan.",
  
  Ceylon: "Dumaan si Rizal sa Ceylon (ngayon ay Sri Lanka) papuntang Europa. Tumigil siya sa Point Galle at namangha sa natural na tanawin ng isla. Ipinahayag niya ang paghanga sa disiplina ng mga tao roon.",
  
  Yemen: "Isa sa mga hintuan ni Rizal sa kanyang paglalakbay patungong Europa. Dito ay naranasan niya ang hirap ng paglalakbay sa disyerto at ang init ng klima. Ipinakita rin dito ang dedikasyon niyang maabot ang kanyang mga layunin.",
  
  Italya: "Namasyal si Rizal sa Naples at iba pang bahagi ng Italya. Napahanga siya sa kasaysayan at arkitektura ng lungsod. Ang Italya ang unang hakbang niya sa lupaing Europeo.",
  
  Pransya: "Nag-aral at nanirahan si Rizal sa Paris, France. Pinag-aralan niya ang medisina at tumutok sa pag-oobserba sa mga ospital at klinika. Muli rin siyang bumalik dito upang ipagpatuloy ang kanyang pagsusulat.",
  
  Espanya: "Dito siya nag-aral sa Universidad Central de Madrid. Kumuha siya ng kursong medisina at pilosopiya. Sa Espanya rin nahubog ang kanyang diwang makabayan at radikal na kaisipan.",
  
  Alemanya: "Dito niya natapos ang kanyang nobelang Noli Me Tangere. Nag-aral siya sa Heidelberg at nagpursige sa larangan ng optalmolohiya. Sa Berlin, nakatagpo siya ng mga tagasuporta at intelektwal na tumulong sa kanya.",
  
  Switzerland: "Namasyal si Rizal sa Switzerland at namuhay ng simple. Kasama si Maximo Viola, nilibot niya ang mga lungsod at bundok. Nagpahinga rin siya dito pagkatapos ng kanyang pagsusulat sa Alemanya.",
  
  Hong_Kong: "Nanirahan dito si Rizal bago bumalik sa Pilipinas. Isinulat niya kay Blumentritt na ang lungsod ay maliit ngunit malinis. Dito niya rin isinasaalang-alang ang kaligtasan ng kanyang pagbabalik sa bayan.",
  
  Macau: "Dumaan si Rizal sa Macau kasama si Basa. Namasyal siya sa mga templo at iba pang tanawin. Pinagmasdan niya ang kultura at buhay ng mga lokal.",
  
  Hapon: "Nahumaling si Rizal sa kultura ng Hapon at nagkaroon ng pag-iibigan. Humanga siya sa disiplina, kalinisan, at kabutihang-asal ng mga Hapon. Isa ito sa mga bansang malapit sa puso niya.",
  
  Estados_Unidos: "Tumawid si Rizal sa Amerika pauwi ng Pilipinas. Dumaan siya sa San Francisco at New York. Nasaksihan niya ang diskriminasyon laban sa mga Asyano at Itim, na nakaapekto sa kanyang pananaw.",
  
  Inglatera: "Nag-aral at nagsaliksik si Rizal sa British Museum. Pinag-aralan niya ang kasaysayan ng Pilipinas gamit ang mga sinaunang dokumento. In-annotate niya ang *Sucesos de las Islas Filipinas* ni Antonio de Morga.",
  
  Belhika: "Dito isinulat ni Rizal ang El Filibusterismo. Natapos niya ito sa Biarritz sa bahay ng kaibigang si Boustead. Ang nobela ay mas madilim at radikal kumpara sa Noli Me Tangere."
};



document.querySelectorAll('.pin').forEach(pin => {
  pin.addEventListener('click', () => {
    const label = pin.dataset.label;
    const info = timeline[label.replaceAll(" ", "_")]; // Converts "United States" to "United_States"
    
    document.getElementById("timeline-description-box").innerHTML = `
      <p><strong>${label}</strong>: ${info || "Walang impormasyon."}</p>
    `;
  });
});


function slowScrollUntilEnd(divId) {
  const element = document.getElementById(divId);
  if (!element) return;

  setTimeout(() => {
    const startScrollPos = window.pageYOffset;
    const rect = element.getBoundingClientRect();
    const elementTopAbsolute = startScrollPos + rect.top;
    const elementHeight = rect.height;

    const maxScrollPos = elementTopAbsolute + elementHeight - window.innerHeight;
    if (maxScrollPos <= startScrollPos) return; // no scrolling needed

    const speed =1; // pixels per frame
    let currentScroll = startScrollPos;
    let isScrolling = true;

    function stopScrolling() {
      isScrolling = false;
      // Remove user scroll listeners when stopping
      window.removeEventListener('wheel', stopScrolling);
      window.removeEventListener('touchmove', stopScrolling);
      window.removeEventListener('keydown', stopScrolling);
      window.removeEventListener('scroll', onScrollCheck);
    }

    // Optional: also stop if user scrolls faster than auto-scroll
    function onScrollCheck() {
      if (Math.abs(window.pageYOffset - currentScroll) > 5) {
        stopScrolling();
      }
    }

    // Listen for user scroll interactions
    window.addEventListener('wheel', stopScrolling, { passive: true });
    window.addEventListener('touchmove', stopScrolling, { passive: true });
    window.addEventListener('keydown', stopScrolling, { passive: true });
    window.addEventListener('scroll', onScrollCheck, { passive: true });

    function step() {
      if (!isScrolling) return;
      currentScroll += speed;
      if (currentScroll >= maxScrollPos) {
        window.scrollTo(0, maxScrollPos);
        stopScrolling();
        return;
      }
      window.scrollTo(0, currentScroll);
      requestAnimationFrame(step);
    }

    step();
  }, 500); // wait for initial jump
}

// Attach event listener on the compass link
const compassLink = document.querySelector('a[href="#gallery"]');

if (compassLink) {
  compassLink.addEventListener('click', () => {
    slowScrollUntilEnd('gallery');
  });
}


